<div class="mb-2 flex flex-row items-center w-full">
  <mat-checkbox
    (change)="cs.selection(row, $event.checked)"
    [checked]="(cs.selectedVariants | async)!.has(cs.hashRow(row))"
  >
  </mat-checkbox>
  <mat-accordion style="width: 100%" class="mr-2">
    <mat-expansion-panel
      (opened)="openPanel(row['Variant'])"
      (closed)="togglePanel = false"
    >
      <mat-expansion-panel-header style="padding: 1rem">
        <mat-panel-title>
          <div
            class="flex items-center w-[200vw] md:w-full lg:w-full xl:w-full font-normal"
          >
            <div class="flex flex-1 flex-row items-center gap-2">
              <div class="flex flex-col gap-1">
                <div class="title-accordion">
                  {{ row["Gene"] }}
                </div>
                <div>
                  {{ row["Variant"] }}
                </div>
              </div>
            </div>
            <div class="flex-1 title-accordion">
              {{ row["Drugs"] }}
            </div>
            <div class="flex-1 flex flex-col gap-1">
              <div>Evidence Level</div>
              <div class="title-accordion">
                {{ row["Level"] }}
              </div>
            </div>
          </div>
        </mat-panel-title>
      </mat-expansion-panel-header>
      <div
        class="data-row border-0 border-t-2 border-gray-300 border-dashed pt-2 flex flex-col gap-2 no-scrollbar pb-2"
        style="height: 300px; overflow: scroll"
      >
        <div class="grid grid-cols-1 md:grid-cols-1 lg:grid-cols-10 gap-4">
          <!-- Card 1 -->
          <div class="lg:col-span-7 bgCard p-4 rounded-xl shadow-md">
            <div class="font-semibold text-base mb-2 border-bottom">
              Prescribing Guidelines
            </div>
            <div class="flex flex-col gap-1">
              <div class="row-content">
                <div>PharmGKB ID</div>
                <div class="row-value">
                  {{ row["PharmGKB ID"] }}
                </div>
              </div>
              <div class="row-content">
                <div>Allele</div>
                <div class="row-value">
                  {{ row["Alleles"] }}
                </div>
              </div>
              <div class="row-content">
                <div>Allele Function</div>
                <div class="row-value">
                  {{ row["Allele Function"] }}
                </div>
              </div>
              <div class="row-content">
                <div>Phenotype Categories</div>
                <div class="row-value">
                  {{ row["Phenotype Categories"] }}
                </div>
              </div>
              <div class="row-content">
                <div>Implications</div>
                <div class="row-value">
                  {{ row["Implication"] }}
                </div>
              </div>
              <div class="row-content">
                <div>Recommendation</div>
                <div class="row-value">
                  {{ row["Recommendation"] }}
                </div>
              </div>
              <div class="row-content">
                <div>Pediatric</div>
                <div class="row-value">
                  {{ row["Pediatric"] }}
                </div>
              </div>
            </div>
          </div>

          <div class="lg:col-span-3 bgCard p-4 rounded-xl shadow-md">
            <div class="font-semibold text-base mb-2 border-bottom">
              <div>Allele Frequency</div>
              <div class="flex flex-row text-sm text-primary-50 mb-2 gap-4">
                <div class="flex-1">gnomAD</div>
              </div>
            </div>
            <div class="flex flex-col gap-1">
              <div class="row-content">
                <div>AF</div>
                <div class="row-value">
                  {{ row["AF"] }}
                </div>
              </div>
              <div class="row-content">
                <div>AC</div>
                <div class="row-value">
                  {{ row["AC"] }}
                </div>
              </div>
              <div class="row-content">
                <div>AN</div>
                <div class="row-value">
                  {{ row["AN"] }}
                </div>
              </div>
              <div class="row-content">
                <div>AFR</div>
                <div class="row-value">
                  {{ row["AF (Afr)"] }}
                </div>
              </div>
              <div class="row-content">
                <div>EAS</div>
                <div class="row-value">
                  {{ row["AF (Eas)"] }}
                </div>
              </div>
              <div class="row-content">
                <div>FIN</div>
                <div class="row-value">
                  {{ row["AF (Fin)"] }}
                </div>
              </div>
              <div class="row-content">
                <div>NFE</div>
                <div class="row-value">
                  {{ row["AF (Nfe)"] }}
                </div>
              </div>
              <div class="row-content">
                <div>SAS</div>
                <div class="row-value">
                  {{ row["AF (Sas)"] }}
                </div>
              </div>
              <div class="row-content">
                <div>AMR</div>
                <div class="row-value">
                  {{ row["AF (Amr)"] }}
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-1 lg:grid-cols-10 gap-4">
          <div class="col-span-4 bgCard p-4 rounded-xl shadow-md">
            <div class="font-semibold text-base mb-2 border-bottom">
              Variant Information (VCF)
            </div>
            <div class="flex flex-col gap-1">
              <div class="row-content">
                <div>ALT/REF</div>
                <div class="row-value">
                  {{ row["VCF alt"] }}/{{ row["VCF ref"] }}
                </div>
              </div>
              <div class="row-content">
                <div>Chr</div>
                <div class="row-value">
                  {{ row["refChr"] }}
                </div>
              </div>
              <div class="row-content">
                <div>Pos</div>
                <div class="row-value">
                  {{ row["VCF pos"] }}
                </div>
              </div>
              <div class="row-content">
                <div>Max SIFT</div>
                <div class="row-value">
                  {{ row["Max sift"] }}
                </div>
              </div>
            </div>
          </div>
          <div class="col-span-4 bgCard p-4 rounded-xl shadow-md">
            <div class="font-semibold text-base mb-2 border-bottom">
              IGNG Table
            </div>
            <div class="flex flex-col gap-1">
              <div class="row-content">
                <div>No.</div>
                <div class="row-value">
                  {{ row["VCF alt"] }}/{{ row["VCF ref"] }}
                </div>
              </div>
              <div class="row-content">
                <div>Chr</div>
                <div class="row-value">
                  {{ row["chr"] }}
                </div>
              </div>
              <div class="row-content">
                <div>Start</div>
                <div class="row-value">
                  {{ row["start"] }}
                </div>
              </div>
              <div class="row-content">
                <div>End</div>
                <div class="row-value">
                  {{ row["end"] }}
                </div>
              </div>
            </div>
          </div>
          <div class="col-span-2 bgCard p-4 rounded-xl shadow-md">
            <app-component-spinner [loading]="loading" />
            <div class="font-semibold text-base mb-2 border-bottom">
              Publication Media
            </div>
            <div class="grid grid-cols-2 gap-2">
              @for (id of pubmed.slice(0, 8); track id) {
                <div
                  class="pub-med p-1 cursor-pointer rounded-md flex justify-center items-center"
                  (click)="handleRedirectUrl(id)"
                >
                  {{ id }}
                </div>
              }
              <!-- code here  -->
              @if (pubmed.length > 8) {
                <div class="relative">
                  <pop-over-component [data]="pubmed.slice(8, pubmed.length)" />
                </div>
              }
            </div>
          </div>
        </div>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
</div>
