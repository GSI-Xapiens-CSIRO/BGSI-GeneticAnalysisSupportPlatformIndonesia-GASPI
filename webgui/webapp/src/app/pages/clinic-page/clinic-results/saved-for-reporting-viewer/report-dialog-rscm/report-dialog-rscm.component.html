<div class="relative min-w-[300px] md:min-w-[700px] max-w-[800px]">
  <h1 mat-dialog-title class="text-2xl font-semibold text-primary mb-4">
    Your Report is Ready to Generate
  </h1>
  <app-component-spinner [loading]="loading"></app-component-spinner>

  <div mat-dialog-content>

    <form [formGroup]="reportForm">
      <p class="text-gray-600 mb-4">Please fill in the following information first</p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

        <!-- Left Column - Patient Information (PII) -->
        <div class="flex flex-col gap-4" formGroupName="pii">
          <mat-form-field>
            <mat-label>Patient Name</mat-label>
            <input
              matInput
              type="text"
              placeholder="Enter patient name"
              formControlName="patient_name"
            />
            <mat-error>{{ getErrorMessage('pii.patient_name') }}</mat-error>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Date of Birth</mat-label>
            <input
              matInput
              type="date"
              formControlName="date_of_birth"
            />
            <mat-error>{{ getErrorMessage('pii.date_of_birth') }}</mat-error>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Rekam Medis</mat-label>
            <input
              matInput
              type="text"
              placeholder="Enter medical record number"
              formControlName="rekam_medis"
            />
            <mat-error>{{ getErrorMessage('pii.rekam_medis') }}</mat-error>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Gender</mat-label>
            <mat-select formControlName="gender">
              <mat-option *ngFor="let option of genderOptions" [value]="option.value">
                {{ option.label }}
              </mat-option>
            </mat-select>
            <mat-error>{{ getErrorMessage('pii.gender') }}</mat-error>
          </mat-form-field>
        </div>

        <!-- Right Column - Medical Information (Non-PII) -->
        <div class="flex flex-col gap-4" formGroupName="nonPii">

          <mat-form-field>
            <mat-label>Clinical Diagnosis</mat-label>
            <input
              matInput
              class="bg-gray-100 cursor-not-allowed"
              readonly
              tabindex="-1"
              type="text"
              placeholder="Enter diagnosis"
              formControlName="clinical_diagnosis"
            />
            <mat-error>{{ getErrorMessage('nonPii.clinical_diagnosis') }}</mat-error>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Symptoms</mat-label>
             <input
              matInput
              type="text"
              placeholder="Enter symptoms"
              formControlName="symptoms"
            />
            <mat-error>{{ getErrorMessage('nonPii.symptoms') }}</mat-error>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Physician</mat-label>
            <input
              matInput
              type="text"
              placeholder="Enter physician name"
              formControlName="physician"
            />
            <mat-error>{{ getErrorMessage('nonPii.physician') }}</mat-error>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Genetic Counselor</mat-label>
            <input
              matInput
              type="text"
              placeholder="Enter genetic counselor name"
              formControlName="genetic_counselor"
            />
            <mat-error>{{ getErrorMessage('nonPii.genetic_counselor') }}</mat-error>
          </mat-form-field>
        </div>
      </div>
    </form>

    <br />
    <div class="flex justify-end space-x-3">
      <button
        class="min-w-[100px]"
        mat-button
        mat-raised-button
        color="primary"
        (click)="onCancel()"
      >
        Cancel
      </button>
      <button
        class="min-w-[140px]"
        mat-raised-button
        color="primary"
        (click)="onSubmit()"
        [disabled]="reportForm.invalid"
      >
        Generate Report
      </button>
    </div>
  </div>
</div>
<a #downloadLink class="invisible" download="report.pdf"></a>
